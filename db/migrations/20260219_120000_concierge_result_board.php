<?php
/**
 * Migration: 의뢰 수행 결과물 전용 게시판 생성
 *
 * - g5_board 에 concierge_result 게시판 등록
 * - write_concierge_result 테이블 생성
 */

if (!defined('_GNUBOARD_')) exit;

global $g5;

// ── 1) 게시판 등록 ──────────────────────────────────
$bo_check = sql_fetch("SELECT bo_table FROM {$g5['board_table']} WHERE bo_table = 'concierge_result'");
if (!$bo_check['bo_table']) {
    sql_query("INSERT INTO `{$g5['board_table']}` SET
        `bo_table` = 'concierge_result',
        `gr_id` = 'community',
        `bo_subject` = '의뢰 수행',
        `bo_device` = 'both',
        `bo_admin` = '',
        `bo_list_level` = 1,
        `bo_read_level` = 1,
        `bo_write_level` = 2,
        `bo_reply_level` = 2,
        `bo_comment_level` = 2,
        `bo_upload_level` = 2,
        `bo_download_level` = 1,
        `bo_html_level` = 1,
        `bo_link_level` = 1,
        `bo_count_modify` = 1,
        `bo_count_delete` = 1,
        `bo_read_point` = 0,
        `bo_write_point` = 0,
        `bo_comment_point` = 0,
        `bo_download_point` = 0,
        `bo_use_category` = 0,
        `bo_category_list` = '',
        `bo_use_sideview` = 0,
        `bo_use_file_content` = 0,
        `bo_use_secret` = 0,
        `bo_use_dhtml_editor` = 1,
        `bo_select_editor` = '',
        `bo_use_rss_view` = 0,
        `bo_use_good` = 1,
        `bo_use_nogood` = 0,
        `bo_use_name` = 0,
        `bo_use_signature` = 0,
        `bo_use_ip_view` = 0,
        `bo_use_list_view` = 0,
        `bo_use_list_file` = 0,
        `bo_use_list_content` = 0,
        `bo_table_width` = 100,
        `bo_subject_len` = 60,
        `bo_mobile_subject_len` = 30,
        `bo_page_rows` = 15,
        `bo_mobile_page_rows` = 15,
        `bo_new` = 24,
        `bo_hot` = 100,
        `bo_image_width` = 835,
        `bo_skin` = 'theme/concierge',
        `bo_mobile_skin` = 'theme/concierge',
        `bo_include_head` = '_head.php',
        `bo_include_tail` = '_tail.php',
        `bo_content_head` = '',
        `bo_mobile_content_head` = '',
        `bo_content_tail` = '',
        `bo_mobile_content_tail` = '',
        `bo_insert_content` = '',
        `bo_gallery_cols` = 4,
        `bo_gallery_width` = 202,
        `bo_gallery_height` = 150,
        `bo_mobile_gallery_width` = 125,
        `bo_mobile_gallery_height` = 100,
        `bo_upload_count` = 2,
        `bo_upload_size` = 1048576,
        `bo_reply_order` = 1,
        `bo_use_search` = 1,
        `bo_order` = 10,
        `bo_count_write` = 0,
        `bo_count_comment` = 0,
        `bo_write_min` = 0,
        `bo_write_max` = 0,
        `bo_comment_min` = 0,
        `bo_comment_max` = 0,
        `bo_notice` = '',
        `bo_use_email` = 0,
        `bo_use_cert` = '',
        `bo_use_sns` = 0,
        `bo_use_captcha` = 0,
        `bo_sort_field` = '',
        `bo_1_subj` = '', `bo_2_subj` = '', `bo_3_subj` = '', `bo_4_subj` = '', `bo_5_subj` = '',
        `bo_6_subj` = '', `bo_7_subj` = '', `bo_8_subj` = '', `bo_9_subj` = '', `bo_10_subj` = '',
        `bo_1` = '', `bo_2` = '', `bo_3` = '', `bo_4` = '', `bo_5` = '',
        `bo_6` = '', `bo_7` = '', `bo_8` = '', `bo_9` = '', `bo_10` = ''
    ");
}

// ── 2) write 테이블 생성 ────────────────────────────
$_wt_name = $g5['write_prefix'] . 'concierge_result';
$wt_check = sql_query("SHOW TABLES LIKE '{$_wt_name}'", false);
if (!$wt_check || !sql_num_rows($wt_check)) {
    sql_query("CREATE TABLE IF NOT EXISTS `{$_wt_name}` (
        `wr_id` int(11) NOT NULL AUTO_INCREMENT,
        `wr_num` int(11) NOT NULL DEFAULT '0',
        `wr_reply` varchar(10) NOT NULL DEFAULT '',
        `wr_parent` int(11) NOT NULL DEFAULT '0',
        `wr_is_comment` tinyint(4) NOT NULL DEFAULT '0',
        `wr_comment` int(11) NOT NULL DEFAULT '0',
        `wr_comment_reply` varchar(5) NOT NULL DEFAULT '',
        `ca_name` varchar(255) NOT NULL DEFAULT '',
        `wr_option` set('html1','html2','secret','mail') NOT NULL DEFAULT '',
        `wr_subject` varchar(255) NOT NULL DEFAULT '',
        `wr_content` text NOT NULL,
        `wr_seo_title` varchar(255) NOT NULL DEFAULT '',
        `wr_link1` text NOT NULL,
        `wr_link2` text NOT NULL,
        `wr_link1_hit` int(11) NOT NULL DEFAULT '0',
        `wr_link2_hit` int(11) NOT NULL DEFAULT '0',
        `wr_hit` int(11) NOT NULL DEFAULT '0',
        `wr_good` int(11) NOT NULL DEFAULT '0',
        `wr_nogood` int(11) NOT NULL DEFAULT '0',
        `mb_id` varchar(20) NOT NULL DEFAULT '',
        `wr_password` varchar(255) NOT NULL DEFAULT '',
        `wr_name` varchar(255) NOT NULL DEFAULT '',
        `wr_email` varchar(255) NOT NULL DEFAULT '',
        `wr_homepage` varchar(255) NOT NULL DEFAULT '',
        `wr_datetime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
        `wr_file` tinyint(4) NOT NULL DEFAULT '0',
        `wr_last` varchar(19) NOT NULL DEFAULT '',
        `wr_ip` varchar(255) NOT NULL DEFAULT '',
        `wr_facebook_user` varchar(255) NOT NULL DEFAULT '',
        `wr_twitter_user` varchar(255) NOT NULL DEFAULT '',
        `wr_1` varchar(255) NOT NULL DEFAULT '',
        `wr_2` varchar(255) NOT NULL DEFAULT '',
        `wr_3` varchar(255) NOT NULL DEFAULT '',
        `wr_4` varchar(255) NOT NULL DEFAULT '',
        `wr_5` varchar(255) NOT NULL DEFAULT '',
        `wr_6` varchar(255) NOT NULL DEFAULT '',
        `wr_7` varchar(255) NOT NULL DEFAULT '',
        `wr_8` varchar(255) NOT NULL DEFAULT '',
        `wr_9` varchar(255) NOT NULL DEFAULT '',
        `wr_10` varchar(255) NOT NULL DEFAULT '',
        PRIMARY KEY (`wr_id`),
        KEY `wr_seo_title` (`wr_seo_title`),
        KEY `wr_num_reply_parent` (`wr_num`,`wr_reply`,`wr_parent`),
        KEY `wr_is_comment` (`wr_is_comment`,`wr_id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci");
}
