# SS Engine (Session Engine) ê¸°íš

> Morgan Edition - ì‹¤ì‹œê°„ TRPG ì„¸ì…˜ íˆ´
> ê¸°ë°˜: vn_engine íŒŒìƒ + Supabase Realtime
> ì°¸ê³ : ì½”ì½”í´ë¦¬ì•„ (Cocofolia)

> âš ï¸ **ê°œë°œ ë‹¨ê³„**: 2ì°¨ ê°œë°œ (Phase 2)
> 1ì°¨ ê°œë°œ ì™„ë£Œ í›„ ì§„í–‰, ë‹¨ í‚¬ëŸ¬ ì½˜í…ì¸ ë¡œì„œ ë°˜ë“œì‹œ êµ¬í˜„ ì˜ˆì •

---

## ê°œìš”

### ëª©ì 
- vn_engineì˜ UI/ì¬ìƒ ì‹œìŠ¤í…œì„ ê¸°ë°˜ìœ¼ë¡œ í•œ **ì‹¤ì‹œê°„ TRPG ì„¸ì…˜ íˆ´**
- ììº ì»¤ë®¤ë‹ˆí‹° íŠ¹í™”: Morgan Edition ìºë¦­í„° ì‹œìŠ¤í…œê³¼ ì—°ë™
- ì½”ì½”í´ë¦¬ì•„ ìŠ¤íƒ€ì¼ì˜ ì„¸ì…˜ ì§„í–‰ + ë¦¬í”Œë ˆì´ ê¸°ëŠ¥

### í•µì‹¬ ê°€ì¹˜
| í•­ëª© | ì„¤ëª… |
|------|------|
| ì‹¤ì‹œê°„ ì„¸ì…˜ | ë‹¤ì¤‘ ì°¸ê°€ì ë™ì‹œ ì§„í–‰ |
| ìºë¦­í„° ì—°ë™ | Morgan Edition ìŠ¹ì¸ëœ ìºë¦­í„° ì‚¬ìš© |
| ì„¸ì…˜ ë…¹í™” | ì§„í–‰ ë‚´ìš© ìë™ ì €ì¥ |
| ë¦¬í”Œë ˆì´ | ì €ì¥ëœ ì„¸ì…˜ì„ VN ìŠ¤íƒ€ì¼ë¡œ ì¬ìƒ |
| ì˜¬ì¸ì› íŒ¨í‚¤ì§€ | Supabase í‚¤ë§Œ ì…ë ¥í•˜ë©´ ì‘ë™ |

### ëª…ì¹­
- **SS Engine**: Session Engineì˜ ì•½ì
- vn_engine (Visual Novel Engine)ì˜ íŒŒìƒ ì—”ì§„

---

## 1. ê¸°ìˆ  ìŠ¤íƒ

### 1.1 ë°±ì—”ë“œ
| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| PHP 8.x | ì„œë²„ ë¡œì§, API |
| MySQL | ì„¸ì…˜ ë©”íƒ€ë°ì´í„°, ë¡œê·¸ ì €ì¥ |
| Supabase | ì‹¤ì‹œê°„ í†µì‹ , ì„¸ì…˜ ìƒíƒœ |

### 1.2 í”„ë¡ íŠ¸ì—”ë“œ
| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| Tailwind CSS | UI ìŠ¤íƒ€ì¼ë§ |
| Vanilla JS | ì„¸ì…˜ ë¡œì§ |
| Supabase JS Client | ì‹¤ì‹œê°„ ì—°ë™ |

### 1.3 vn_engine ì¬ì‚¬ìš©
| ê¸°ëŠ¥ | íŒŒì¼ | í™œìš© |
|------|------|------|
| ìºë¦­í„° í‘œì‹œ | play.php | ì„¸ì…˜ ìºë¦­í„° ë Œë”ë§ |
| ë°°ê²½ ì‹œìŠ¤í…œ | backgrounds.php | ì”¬ ë°°ê²½ |
| BGM ì‹œìŠ¤í…œ | bgm.php | ì„¸ì…˜ BGM |
| ëŒ€í™”ì°½ UI | settings.php | ì±„íŒ… ìŠ¤íƒ€ì¼ |
| ì• ë‹ˆë©”ì´ì…˜ | play.php | ìºë¦­í„° ë“±ì¥/í‡´ì¥ |
| ë¦¬í”Œë ˆì´ | play.php | ì„¸ì…˜ ì¬ìƒ |

---

## 2. í´ë” êµ¬ì¡°

```
ss_engine/
â”œâ”€â”€ install.php                 # ì„¤ì¹˜ (DB + Supabase í…ŒìŠ¤íŠ¸)
â”œâ”€â”€ config.sample.php           # Supabase ì„¤ì • í…œí”Œë¦¿
â”œâ”€â”€ config.php                  # ì‹¤ì œ ì„¤ì • (gitignore)
â”œâ”€â”€ api.php                     # REST API
â”‚
â”œâ”€â”€ index.php                   # ì„¸ì…˜ ëª©ë¡/ëŒ€ì‹œë³´ë“œ
â”œâ”€â”€ create.php                  # ì„¸ì…˜ ìƒì„±
â”‚
â”œâ”€â”€ session/
â”‚   â”œâ”€â”€ room.php                # ì„¸ì…˜ ì§„í–‰ (ë©”ì¸)
â”‚   â”œâ”€â”€ gm.php                  # GM ì „ìš© ì œì–´íŒ
â”‚   â”œâ”€â”€ join.php                # ì„¸ì…˜ ì°¸ê°€
â”‚   â””â”€â”€ replay.php              # ë¦¬í”Œë ˆì´ ë·°ì–´
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ ss.lib.php              # SS Engine ê³µí†µ í•¨ìˆ˜
â”‚   â”œâ”€â”€ dice.lib.php            # ë‹¤ì´ìŠ¤ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ supabase.lib.php        # Supabase í—¬í¼
â”‚
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ supabase-client.js      # Supabase ì´ˆê¸°í™”
â”‚   â”œâ”€â”€ session.js              # ì„¸ì…˜ ë©”ì¸ ë¡œì§
â”‚   â”œâ”€â”€ gm-panel.js             # GM ì œì–´íŒ ë¡œì§
â”‚   â”œâ”€â”€ dice.js                 # ë‹¤ì´ìŠ¤ íŒŒì„œ/ë¡¤ëŸ¬
â”‚   â”œâ”€â”€ chat.js                 # ì±„íŒ… UI
â”‚   â””â”€â”€ replay.js               # ë¦¬í”Œë ˆì´ ë¡œì§
â”‚
â”œâ”€â”€ css/
â”‚   â””â”€â”€ session.css             # ì„¸ì…˜ ì „ìš© ìŠ¤íƒ€ì¼
â”‚
â””â”€â”€ assets/
    â”œâ”€â”€ dice/                   # ë‹¤ì´ìŠ¤ ì´ë¯¸ì§€/ì• ë‹ˆë©”ì´ì…˜
    â””â”€â”€ sounds/                 # íš¨ê³¼ìŒ (ë‹¤ì´ìŠ¤, ì•Œë¦¼)
```

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### 3.1 Morgan Edition í…Œì´ë¸” (mg_ ì ‘ë‘ì‚¬)

#### mg_ss_room (ì„¸ì…˜ ë°©)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| room_id | int AUTO_INCREMENT | PK |
| room_code | varchar(20) | ì…ì¥ ì½”ë“œ (UNIQUE) |
| room_name | varchar(100) | ì„¸ì…˜ëª… |
| room_desc | text | ì„¸ì…˜ ì„¤ëª… |
| gm_mb_id | varchar(20) | GM íšŒì› ID |
| max_players | int | ìµœëŒ€ ì°¸ê°€ì (0=ë¬´ì œí•œ) |
| status | enum | waiting/playing/paused/ended |
| is_public | tinyint(1) | ê³µê°œ ì—¬ë¶€ |
| allow_spectator | tinyint(1) | ê´€ì „ í—ˆìš© |
| current_scene_id | int | í˜„ì¬ ì”¬ ID (FK) |
| current_bgm_id | int | í˜„ì¬ BGM ID (FK) |
| supabase_channel | varchar(100) | Supabase ì±„ë„ëª… |
| created_at | datetime | ìƒì„±ì¼ |
| started_at | datetime | ì‹œì‘ì¼ (nullable) |
| ended_at | datetime | ì¢…ë£Œì¼ (nullable) |

#### mg_ss_scene (ì„¸ì…˜ ì”¬/ë°°ê²½)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| scene_id | int AUTO_INCREMENT | PK |
| room_id | int | ë°© ID (FK) |
| scene_name | varchar(100) | ì”¬ ì´ë¦„ |
| bg_image | varchar(500) | ë°°ê²½ ì´ë¯¸ì§€ |
| description | text | ì”¬ ì„¤ëª… (GMìš©) |
| sort_order | int | ì •ë ¬ ìˆœì„œ |

#### mg_ss_bgm (ì„¸ì…˜ BGM)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| bgm_id | int AUTO_INCREMENT | PK |
| room_id | int | ë°© ID (FK) |
| bgm_name | varchar(100) | BGM ì´ë¦„ |
| source_type | enum | file/url/youtube |
| file_path | varchar(500) | íŒŒì¼ ê²½ë¡œ |
| external_url | varchar(500) | ì™¸ë¶€ URL |
| youtube_id | varchar(20) | YouTube ID |
| volume | tinyint | ë³¼ë¥¨ (0-100) |
| sort_order | int | ì •ë ¬ ìˆœì„œ |

#### mg_ss_participant (ì„¸ì…˜ ì°¸ê°€ì)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| part_id | int AUTO_INCREMENT | PK |
| room_id | int | ë°© ID (FK) |
| mb_id | varchar(20) | íšŒì› ID |
| ch_id | int | ìºë¦­í„° ID (FK â†’ mg_character) |
| role | enum | gm/player/spectator |
| is_active | tinyint(1) | í˜„ì¬ ì ‘ì† ì¤‘ |
| joined_at | datetime | ì°¸ê°€ì¼ |
| left_at | datetime | í‡´ì¥ì¼ (nullable) |

#### mg_ss_npc (ì„¸ì…˜ NPC)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| npc_id | int AUTO_INCREMENT | PK |
| room_id | int | ë°© ID (FK) |
| npc_name | varchar(100) | NPC ì´ë¦„ |
| npc_image | varchar(500) | NPC ì´ë¯¸ì§€ |
| npc_color | varchar(7) | ì´ë¦„ ìƒ‰ìƒ (#hex) |
| description | text | NPC ì„¤ëª… |
| is_visible | tinyint(1) | í˜„ì¬ í‘œì‹œ ì¤‘ |
| position | enum | left/center/right/hidden |
| sort_order | int | ì •ë ¬ ìˆœì„œ |

#### mg_ss_log (ì„¸ì…˜ ë¡œê·¸)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| log_id | int AUTO_INCREMENT | PK |
| room_id | int | ë°© ID (FK) |
| log_type | enum | chat/dice/scene/bgm/npc/system |
| mb_id | varchar(20) | ì‘ì„±ì (nullable for system) |
| ch_id | int | ìºë¦­í„° ID (nullable) |
| speaker_name | varchar(100) | í‘œì‹œ ì´ë¦„ |
| speaker_color | varchar(7) | ì´ë¦„ ìƒ‰ìƒ |
| content | text | ë©”ì‹œì§€ ë‚´ìš© |
| dice_command | varchar(50) | ë‹¤ì´ìŠ¤ ëª…ë ¹ì–´ (nullable) |
| dice_result | varchar(100) | ë‹¤ì´ìŠ¤ ê²°ê³¼ (nullable) |
| extra_data | text | ì¶”ê°€ ë°ì´í„° (JSON) |
| created_at | datetime | ìƒì„±ì¼ |

**extra_data ì˜ˆì‹œ:**
```json
// scene ë³€ê²½
{ "scene_id": 3, "scene_name": "ë˜ì „ ì…êµ¬" }

// bgm ë³€ê²½
{ "bgm_id": 2, "bgm_name": "ê¸´ì¥ê°" }

// npc ë“±ì¥
{ "npc_id": 1, "npc_name": "ê³ ë¸”ë¦°", "action": "enter", "position": "center" }

// ë‹¤ì´ìŠ¤
{ "command": "1d100", "rolls": [45], "total": 45, "success": true }
```

#### mg_ss_replay (ë¦¬í”Œë ˆì´ ë°ì´í„°)

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| replay_id | int AUTO_INCREMENT | PK |
| room_id | int | ì›ë³¸ ë°© ID (FK) |
| replay_title | varchar(200) | ë¦¬í”Œë ˆì´ ì œëª© |
| replay_desc | text | ì„¤ëª… |
| is_public | tinyint(1) | ê³µê°œ ì—¬ë¶€ |
| view_count | int | ì¡°íšŒìˆ˜ |
| node_data | longtext | VN ë…¸ë“œ í˜•ì‹ ë³€í™˜ ë°ì´í„° (JSON) |
| created_at | datetime | ìƒì„±ì¼ |

### 3.2 Supabase í…Œì´ë¸” (ì‹¤ì‹œê°„ìš©)

> SupabaseëŠ” ì‹¤ì‹œê°„ í†µì‹ ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©, ì˜êµ¬ ë°ì´í„°ëŠ” MySQLì— ì €ì¥

```sql
-- Supabaseì—ëŠ” í…Œì´ë¸” ìƒì„± ë¶ˆí•„ìš”
-- Broadcast + Presence ê¸°ëŠ¥ë§Œ ì‚¬ìš©
```

---

## 4. Supabase ì—°ë™

### 4.1 ì„¤ì • íŒŒì¼

**config.sample.php**
```php
<?php
/**
 * SS Engine - Supabase ì„¤ì •
 *
 * 1. https://supabase.com íšŒì›ê°€ì…
 * 2. ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
 * 3. Settings > APIì—ì„œ ì•„ë˜ ê°’ ë³µì‚¬
 * 4. ì´ íŒŒì¼ì„ config.phpë¡œ ë³µì‚¬ í›„ ê°’ ì…ë ¥
 */

// Supabase í”„ë¡œì íŠ¸ URL
define('SS_SUPABASE_URL', 'https://your-project.supabase.co');

// Supabase anon/public í‚¤ (í´ë¼ì´ì–¸íŠ¸ìš©)
define('SS_SUPABASE_ANON_KEY', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...');

// Supabase service_role í‚¤ (ì„œë²„ìš©, ì„ íƒì )
define('SS_SUPABASE_SERVICE_KEY', '');
```

### 4.2 ì‹¤ì‹œê°„ ì±„ë„ êµ¬ì¡°

```javascript
// ì„¸ì…˜ ì±„ë„ êµ¬ë…
const roomChannel = supabase.channel(`ss_room:${roomCode}`, {
  config: {
    presence: { key: odId },  // ì°¸ê°€ì ì‹ë³„
  }
});

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
roomChannel
  // ì±„íŒ… ë©”ì‹œì§€
  .on('broadcast', { event: 'chat' }, ({ payload }) => {
    addChatMessage(payload);
  })

  // ë‹¤ì´ìŠ¤ ê²°ê³¼
  .on('broadcast', { event: 'dice' }, ({ payload }) => {
    showDiceResult(payload);
  })

  // ì”¬ ë³€ê²½ (GM)
  .on('broadcast', { event: 'scene' }, ({ payload }) => {
    changeScene(payload);
  })

  // BGM ë³€ê²½ (GM)
  .on('broadcast', { event: 'bgm' }, ({ payload }) => {
    changeBgm(payload);
  })

  // NPC ì œì–´ (GM)
  .on('broadcast', { event: 'npc' }, ({ payload }) => {
    controlNpc(payload);
  })

  // ì‹œìŠ¤í…œ ë©”ì‹œì§€
  .on('broadcast', { event: 'system' }, ({ payload }) => {
    showSystemMessage(payload);
  })

  // ì°¸ê°€ì ìƒíƒœ (Presence)
  .on('presence', { event: 'sync' }, () => {
    updateParticipantList(roomChannel.presenceState());
  })

  .subscribe();
```

### 4.3 ë©”ì‹œì§€ ì „ì†¡

```javascript
// ì±„íŒ… ì „ì†¡
async function sendChat(content) {
  const payload = {
    mb_id: currentUser.mb_id,
    ch_id: currentCharacter.ch_id,
    speaker_name: currentCharacter.ch_name,
    speaker_color: currentCharacter.name_color,
    content: content,
    timestamp: Date.now()
  };

  // Supabase broadcast
  await roomChannel.send({
    type: 'broadcast',
    event: 'chat',
    payload: payload
  });

  // MySQL ë¡œê·¸ ì €ì¥ (API)
  await fetch('/ss_engine/api.php?mode=log_add', {
    method: 'POST',
    body: JSON.stringify({ ...payload, log_type: 'chat' })
  });
}

// ë‹¤ì´ìŠ¤ ì „ì†¡
async function sendDice(command) {
  const result = rollDice(command);  // { command, rolls, total, ... }

  const payload = {
    mb_id: currentUser.mb_id,
    ch_id: currentCharacter.ch_id,
    speaker_name: currentCharacter.ch_name,
    dice_command: command,
    dice_result: result,
    timestamp: Date.now()
  };

  await roomChannel.send({
    type: 'broadcast',
    event: 'dice',
    payload: payload
  });

  // ë¡œê·¸ ì €ì¥
  await fetch('/ss_engine/api.php?mode=log_add', {
    method: 'POST',
    body: JSON.stringify({ ...payload, log_type: 'dice' })
  });
}
```

---

## 5. ë‹¤ì´ìŠ¤ ì‹œìŠ¤í…œ (ë©€í‹° ë£°ì…‹ ì§€ì›)

> ì„¸ì…˜ ìƒì„± ì‹œ ë£°ì…‹ ì„ íƒ â†’ í•´ë‹¹ ë£°ì…‹ì˜ íŒì • ì‹œìŠ¤í…œ ì ìš©
> ìºë¦­í„° ìŠ¤íƒ¯ê³¼ ì—°ë™í•˜ì—¬ ìë™ íŒì •

### 5.1 ì§€ì› ë£°ì…‹

| ë£°ì…‹ | ê¸°ë³¸ ë‹¤ì´ìŠ¤ | íŒì • ë°©ì‹ |
|------|------------|----------|
| CoC 7íŒ | d100 | ê¸°ìˆ ì¹˜ ì´í•˜ ì„±ê³µ (5ë‹¨ê³„ ë ˆë²¨) |
| D&D 5e | d20 | ìˆ˜ì •ì¹˜ + d20 vs DC |
| VtM 5íŒ | d10 í’€ | ì„±ê³µ(6+) ì¹´ìš´íŠ¸, í—ê±° ë‹¤ì´ìŠ¤ |

### 5.2 ê³µí†µ ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª… | ì˜ˆì‹œ |
|--------|------|------|
| NdX | Nê°œì˜ Xë©´ì²´ ë‹¤ì´ìŠ¤ | 2d6, 1d100 |
| NdX+M | ìˆ˜ì •ì¹˜ ì¶”ê°€ | 1d20+5 |
| NdX-M | ìˆ˜ì •ì¹˜ ê°ì†Œ | 2d6-2 |
| NdXkH/kL | ë†’ì€/ë‚®ì€ Nê°œ ìœ ì§€ | 4d6k3 (ë†’ì€ 3ê°œ) |

### 5.3 CoC 7íŒ ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª… | ì˜ˆì‹œ |
|--------|------|------|
| cc | ê¸°ìˆ  íŒì • | cc ë°œê²¬ (ìºë¦­í„° ìŠ¤í‚¬ê°’ ìë™ ì°¸ì¡°) |
| ccb | ë³´ë„ˆìŠ¤ ë‹¤ì´ìŠ¤ | ccb ë°œê²¬ (ìœ ë¦¬í•œ ìƒí™©) |
| ccp | í˜ë„í‹° ë‹¤ì´ìŠ¤ | ccp ë°œê²¬ (ë¶ˆë¦¬í•œ ìƒí™©) |
| san | SAN ì²´í¬ | san 1d6/1d20 (ì„±ê³µ/ì‹¤íŒ¨ ì†ì‹¤) |
| res | ëŒ€í•­ íŒì • | res STR vs STR |

### 5.4 D&D 5e ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª… | ì˜ˆì‹œ |
|--------|------|------|
| check | ëŠ¥ë ¥ì¹˜ ì²´í¬ | check STR (d20 + ìˆ˜ì •ì¹˜) |
| save | ì„¸ì´ë¸Œ | save DEX DC15 |
| attack | ê³µê²© êµ´ë¦¼ | attack +5 AC17 |
| adv | ì´ì  (2d20 ë†’ì€ê°’) | adv STR |
| dis | ë¶ˆë¦¬ (2d20 ë‚®ì€ê°’) | dis DEX |
| init | ì„ ì œê¶Œ | init (DEX + d20) |

### 5.5 VtM 5íŒ ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª… | ì˜ˆì‹œ |
|--------|------|------|
| pool | ë‹¤ì´ìŠ¤ í’€ | pool 5 (5d10 êµ´ë¦¼) |
| v | ë±€íŒŒì´ì–´ íŒì • | v 5h2 (5ê°œ í’€, 2ê°œ í—ê±°) |
| rouse | ê°ì„± ì²´í¬ | rouse (1d10, 1ì´ë©´ í—ê±°+1) |
| frenzy | ê´‘ë€ ì²´í¬ | frenzy 3 (ì˜ì§€ë ¥ vs DC) |

### 5.2 CoC íŒì • ê·œì¹™

**ì„±ê³µ ë ˆë²¨:**
| ê²°ê³¼ | ì¡°ê±´ | ì„¤ëª… |
|------|------|------|
| ëŒ€ì„±ê³µ | 01 | ë¬´ì¡°ê±´ ì„±ê³µ |
| ìµìŠ¤íŠ¸ë¦¼ | â‰¤ ê¸°ìˆ /5 | ê·¹í•œ ì„±ê³µ |
| í•˜ë“œ | â‰¤ ê¸°ìˆ /2 | ì–´ë ¤ìš´ ì„±ê³µ |
| ì¼ë°˜ | â‰¤ ê¸°ìˆ  | ì¼ë°˜ ì„±ê³µ |
| ì‹¤íŒ¨ | > ê¸°ìˆ  | ì‹¤íŒ¨ |
| ëŒ€ì‹¤íŒ¨ | 96-00 (ê¸°ìˆ <50) / 100 (ê¸°ìˆ â‰¥50) | íŒë¸” |

**ë³´ë„ˆìŠ¤/í˜ë„í‹° ë‹¤ì´ìŠ¤:**
- ë³´ë„ˆìŠ¤: 10ì˜ ìë¦¬ ë‹¤ì´ìŠ¤ 2ê°œ â†’ ë‚®ì€ ê°’ ì„ íƒ
- í˜ë„í‹°: 10ì˜ ìë¦¬ ë‹¤ì´ìŠ¤ 2ê°œ â†’ ë†’ì€ ê°’ ì„ íƒ

### 5.3 íŒì • UI (ì„¸ì…˜ ë‚´)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ² CoC íŒì •                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ìŠ¤íƒ¯ íŒì •                              â”‚
â”‚  [STR 60] [CON 55] [DEX 70] [INT 65]   â”‚
â”‚  [POW 50] [EDU 75] [APP 60] [LCK 45]   â”‚
â”‚                                         â”‚
â”‚  ìŠ¤í‚¬ íŒì •                              â”‚
â”‚  [ë°œê²¬ 40%] [íšŒí”¼ 35%] [ì€ì‹  30%]       â”‚
â”‚  [ì„¤ë“ 25%] [ì‹¬ë¦¬í•™ 20%] [...]          â”‚
â”‚                                         â”‚
â”‚  íŠ¹ìˆ˜                                   â”‚
â”‚  [SAN ì²´í¬] [ëŒ€í•­ íŒì •] [í”¼í•´ êµ´ë¦¼]     â”‚
â”‚                                         â”‚
â”‚  ë³´ì •: ( ) ë³´ë„ˆìŠ¤  ( ) í˜ë„í‹°  (â—) ì—†ìŒ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì»¤ìŠ¤í…€: [________] [êµ´ë¦¬ê¸°]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 íŒì • ê²°ê³¼ í‘œì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ² [ì•„ë¦¬ì•„] ë°œê²¬ íŒì •                   â”‚
â”‚                                         â”‚
â”‚     â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®                    â”‚
â”‚     â”‚      23      â”‚  â† êµ´ë¦¼            â”‚
â”‚     â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯                    â”‚
â”‚                                         â”‚
â”‚     ê¸°ìˆ ì¹˜: 40%                          â”‚
â”‚     í•˜ë“œ: 20% / ìµìŠ¤íŠ¸ë¦¼: 8%             â”‚
â”‚                                         â”‚
â”‚     âœ“ ì¼ë°˜ ì„±ê³µ!                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**SAN ì²´í¬ ê²°ê³¼:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ˜± [ë ˆì˜¨] SAN ì²´í¬                      â”‚
â”‚                                         â”‚
â”‚     êµ´ë¦¼: 67 / SAN: 55                  â”‚
â”‚     âœ— ì‹¤íŒ¨! 1d6 ì†ì‹¤                    â”‚
â”‚                                         â”‚
â”‚     ğŸ² ì†ì‹¤: 4                           â”‚
â”‚     SAN: 55 â†’ 51                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.5 CoC ë‹¤ì´ìŠ¤ íŒŒì„œ

```javascript
// dice.js - CoC 7íŒ í™•ì¥
const COC_DICE = {
  // ì„±ê³µ ë ˆë²¨ íŒì •
  checkSuccess(roll, skill) {
    if (roll === 1) return { level: 'critical', label: 'ëŒ€ì„±ê³µ' };
    if (roll <= Math.floor(skill / 5)) return { level: 'extreme', label: 'ìµìŠ¤íŠ¸ë¦¼' };
    if (roll <= Math.floor(skill / 2)) return { level: 'hard', label: 'í•˜ë“œ' };
    if (roll <= skill) return { level: 'regular', label: 'ì„±ê³µ' };
    if ((skill < 50 && roll >= 96) || roll === 100) return { level: 'fumble', label: 'ëŒ€ì‹¤íŒ¨' };
    return { level: 'failure', label: 'ì‹¤íŒ¨' };
  },

  // CoC íŒì • (cc ëª…ë ¹ì–´)
  rollSkillCheck(skillValue, bonusDice = 0) {
    const tens = [];
    const diceCount = 1 + Math.abs(bonusDice);

    // 10ì˜ ìë¦¬ ë‹¤ì´ìŠ¤ë“¤
    for (let i = 0; i < diceCount; i++) {
      tens.push(Math.floor(Math.random() * 10) * 10);
    }
    // 1ì˜ ìë¦¬ ë‹¤ì´ìŠ¤
    const ones = Math.floor(Math.random() * 10);

    // ë³´ë„ˆìŠ¤/í˜ë„í‹° ì ìš©
    let selectedTens;
    if (bonusDice > 0) {
      selectedTens = Math.min(...tens); // ë³´ë„ˆìŠ¤: ë‚®ì€ ê°’
    } else if (bonusDice < 0) {
      selectedTens = Math.max(...tens); // í˜ë„í‹°: ë†’ì€ ê°’
    } else {
      selectedTens = tens[0];
    }

    // 00 + 0 = 100 ì²˜ë¦¬
    let total = selectedTens + ones;
    if (total === 0) total = 100;

    const result = this.checkSuccess(total, skillValue);

    return {
      roll: total,
      tens: tens,
      ones: ones,
      selectedTens: selectedTens,
      skillValue: skillValue,
      ...result
    };
  },

  // SAN ì²´í¬
  rollSanCheck(currentSan, successLoss, failureLoss) {
    const roll = Math.floor(Math.random() * 100) + 1;
    const success = roll <= currentSan;

    // ì†ì‹¤ êµ´ë¦¼
    const lossRoll = success
      ? this.rollDice(successLoss)
      : this.rollDice(failureLoss);

    return {
      roll: roll,
      san: currentSan,
      success: success,
      lossFormula: success ? successLoss : failureLoss,
      lossRoll: lossRoll.total,
      newSan: Math.max(0, currentSan - lossRoll.total)
    };
  },

  // ì¼ë°˜ ë‹¤ì´ìŠ¤
  rollDice(command) {
    const match = command.match(/(\d+)d(\d+)([+-]\d+)?/i);
    if (!match) return { total: 0, rolls: [] };

    const count = parseInt(match[1]);
    const sides = parseInt(match[2]);
    const modifier = match[3] ? parseInt(match[3]) : 0;

    const rolls = [];
    for (let i = 0; i < count; i++) {
      rolls.push(Math.floor(Math.random() * sides) + 1);
    }

    return {
      command: command,
      rolls: rolls,
      modifier: modifier,
      total: rolls.reduce((a, b) => a + b, 0) + modifier
    };
  }
};
```

### 5.3 ë‹¤ì´ìŠ¤ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ² ë‹¤ì´ìŠ¤                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [1d100] [1d20] [2d6] [1d6]    â”‚
â”‚                                 â”‚
â”‚  ì»¤ìŠ¤í…€: [________] [êµ´ë¦¬ê¸°]    â”‚
â”‚                                 â”‚
â”‚  ìµœê·¼:                          â”‚
â”‚  â”” 1d100 â†’ 45                   â”‚
â”‚  â”” 2d6+3 â†’ 11 (4+4+3)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. UI ì„¤ê³„

### 6.1 ì„¸ì…˜ ë©”ì¸ í™”ë©´ (room.php)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [< ëª©ë¡] ì„¸ì…˜: ë˜ì „ íƒí—˜ #3              [ğŸ‘¥ 4/6] [âš™] [ğŸšª í‡´ì¥] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    [ë°°ê²½ ì´ë¯¸ì§€]                        â”‚   â”‚
â”‚  â”‚                   ì–´ë‘ìš´ ë™êµ´ ì…êµ¬                       â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚   â”‚     â”‚              â”‚     â”‚              â”‚     â”‚    â”‚   â”‚
â”‚  â”‚   â”‚ ìºA â”‚              â”‚ NPC â”‚              â”‚ ìºB â”‚    â”‚   â”‚
â”‚  â”‚   â”‚     â”‚              â”‚     â”‚              â”‚     â”‚    â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚    (ì¢Œì¸¡)               (ì¤‘ì•™)               (ìš°ì¸¡)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ’¬ ì±„íŒ…                                          [ë¡œê·¸]  â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚  [ì•„ë¦¬ì•„] ì—¬ê¸°ê°€ ë˜ì „ ì…êµ¬ì¸ ê²ƒ ê°™ì•„.                     â”‚  â”‚
â”‚  â”‚  [ë ˆì˜¨] ì¡°ì‚¬í•´ë³¼ê²Œ.                                      â”‚  â”‚
â”‚  â”‚  ğŸ² [ë ˆì˜¨] 1d100 â†’ 45 (ì„±ê³µ!)                           â”‚  â”‚
â”‚  â”‚  ğŸ“¢ [GM] ê³ ëŒ€ ë¬¸ìê°€ ìƒˆê²¨ì§„ ì„íŒì´ ë³´ì¸ë‹¤.               â”‚  â”‚
â”‚  â”‚  [ì•„ë¦¬ì•„] í•´ë…í•  ìˆ˜ ìˆì„ê¹Œ?                              â”‚  â”‚
â”‚  â”‚  ğŸ² [ì•„ë¦¬ì•„] 1d100 â†’ 78 (ì‹¤íŒ¨)                          â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ìºë¦­í„°: [ì•„ë¦¬ì•„ â–¼]  [ë©”ì‹œì§€ ì…ë ¥...              ] [ğŸ²] [ì „ì†¡] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 GM ì œì–´íŒ (gm.php)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GM ì œì–´íŒ                    [ë‹«ê¸°]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  ğŸ“ ì”¬ ì „í™˜                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ë˜ì „ ì…êµ¬      â–¼] [ì ìš©]      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [+ ìƒˆ ì”¬ ì¶”ê°€]                        â”‚
â”‚                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  ğŸµ BGM                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ê¸´ì¥ê°         â–¼]             â”‚   â”‚
â”‚  â”‚ [â–¶ ì¬ìƒ] [â¸ ì¼ì‹œì •ì§€] [â¹ ì •ì§€] â”‚   â”‚
â”‚  â”‚ ë³¼ë¥¨: [â”€â”€â”€â”€â—â”€â”€â”€â”€] 70%          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [+ BGM ì¶”ê°€]                          â”‚
â”‚                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  ğŸ‘¤ NPC ê´€ë¦¬                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ê³ ë¸”ë¦°   [ì¢Œì¸¡â–¼] [ë“±ì¥] [í‡´ì¥] â”‚   â”‚
â”‚  â”‚ ìƒì¸     [ìˆ¨ê¹€â–¼] [ë“±ì¥] [í‡´ì¥] â”‚   â”‚
â”‚  â”‚ ë§ˆë²•ì‚¬   [ì¤‘ì•™â–¼] [ë“±ì¥] [í‡´ì¥] â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [+ NPC ì¶”ê°€]                          â”‚
â”‚                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  ğŸ“¢ ì‹œìŠ¤í…œ ë©”ì‹œì§€                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ì‹œìŠ¤í…œ ë©”ì‹œì§€ ì…ë ¥...    ]    â”‚   â”‚
â”‚  â”‚                        [ì „ì†¡]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  âº ì„¸ì…˜ ìƒíƒœ                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ìƒíƒœ: ì§„í–‰ì¤‘ (01:23:45)        â”‚   â”‚
â”‚  â”‚ ë¡œê·¸: 127ê±´                    â”‚   â”‚
â”‚  â”‚                                â”‚   â”‚
â”‚  â”‚ [â¸ ì¼ì‹œì •ì§€] [â¹ ì„¸ì…˜ ì¢…ë£Œ]    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ì°¸ê°€ì íŒ¨ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¥ ì°¸ê°€ì (4/6)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘‘ GM                 â”‚
â”‚     user123            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ­ í”Œë ˆì´ì–´           â”‚
â”‚  â”œâ”€ [ì¸ë„¤ì¼] ì•„ë¦¬ì•„    â”‚
â”‚  â”‚   @player1 (ì ‘ì†ì¤‘) â”‚
â”‚  â”œâ”€ [ì¸ë„¤ì¼] ë ˆì˜¨      â”‚
â”‚  â”‚   @player2 (ì ‘ì†ì¤‘) â”‚
â”‚  â””â”€ [ì¸ë„¤ì¼] ë¯¸ì•„      â”‚
â”‚      @player3 (ìë¦¬ë¹„ì›€)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘ ê´€ì „ì             â”‚
â”‚  â””â”€ @spectator1        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4 ì„¸ì…˜ ëª©ë¡ (index.php)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SS Engine - ì„¸ì…˜ ëª©ë¡                           [+ ìƒˆ ì„¸ì…˜]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ”´ ì§„í–‰ì¤‘                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ë˜ì „ íƒí—˜ #3                              [4/6] [ì…ì¥]  â”‚   â”‚
â”‚  â”‚  GM: user123 | ì‹œì‘: 2ì‹œê°„ ì „                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  ë¯¸ìŠ¤í„°ë¦¬ ì €íƒ                             [3/4] [ì…ì¥]  â”‚   â”‚
â”‚  â”‚  GM: user456 | ì‹œì‘: 30ë¶„ ì „                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  ğŸŸ¡ ëŒ€ê¸°ì¤‘                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ì£¼ë§ ì„¸ì…˜ (ì˜ˆì •)                          [2/5] [ì°¸ê°€]  â”‚   â”‚
â”‚  â”‚  GM: user789 | ìƒì„±: 1ì¼ ì „                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  âš« ì¢…ë£Œë¨ (ìµœê·¼)                                    [ë”ë³´ê¸°]   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ë˜ì „ íƒí—˜ #2                    [ë¦¬í”Œë ˆì´] [ë¡œê·¸ ë³´ê¸°]  â”‚   â”‚
â”‚  â”‚  GM: user123 | ì¢…ë£Œ: 3ì¼ ì „ | ì¬ìƒ: 42íšŒ               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Morgan Edition ì—°ë™

### 7.0 CoC ìºë¦­í„° ìŠ¤íƒ¯ ì—°ë™

> ìºë¦­í„°ì˜ CoC ìŠ¤íƒ¯ì„ ì„¸ì…˜ì—ì„œ í™œìš©

```php
// ìºë¦­í„° ìŠ¤íƒ¯ ê°€ì ¸ì˜¤ê¸°
function get_character_stats($ch_id) {
    global $g5;

    $sql = "SELECT * FROM {$g5['mg_character_stat_table']}
            WHERE ch_id = {$ch_id}";
    return sql_fetch($sql);
}

// ìŠ¤í‚¬ ê°’ ê°€ì ¸ì˜¤ê¸° (í”„ë¡œí•„ í•„ë“œì—ì„œ)
function get_character_skills($ch_id) {
    global $g5;

    $sql = "SELECT pf.pf_code, pv.pv_value
            FROM {$g5['mg_profile_value_table']} pv
            JOIN {$g5['mg_profile_field_table']} pf ON pv.pf_id = pf.pf_id
            WHERE pv.ch_id = {$ch_id}
            AND pf.pf_category = 'ìŠ¤í‚¬'";

    $result = sql_query($sql);
    $skills = [];
    while ($row = sql_fetch_array($result)) {
        $skills[$row['pf_code']] = (int)$row['pv_value'];
    }
    return $skills;
}

// ì„¸ì…˜ìš© ìºë¦­í„° ë°ì´í„° (ìŠ¤íƒ¯ í¬í•¨)
function character_to_session_data($ch_id) {
    $char = mg_get_character($ch_id);
    $stats = get_character_stats($ch_id);
    $skills = get_character_skills($ch_id);

    return [
        'ch_id' => $char['ch_id'],
        'ch_name' => $char['ch_name'],
        'ch_thumb' => $char['ch_thumb'],
        'stats' => [
            'str' => $stats['stat_str'],
            'con' => $stats['stat_con'],
            'siz' => $stats['stat_siz'],
            'dex' => $stats['stat_dex'],
            'app' => $stats['stat_app'],
            'int' => $stats['stat_int'],
            'pow' => $stats['stat_pow'],
            'edu' => $stats['stat_edu'],
            'lck' => $stats['stat_lck'],
        ],
        'derived' => [
            'hp_current' => $stats['hp_current'],
            'hp_max' => $stats['hp_max'],
            'mp_current' => $stats['mp_current'],
            'mp_max' => $stats['mp_max'],
            'san_current' => $stats['san_current'],
            'san_max' => $stats['san_max'],
        ],
        'skills' => $skills
    ];
}
```

### 7.0.1 ì„¸ì…˜ ì¤‘ ìŠ¤íƒ¯ ë³€ë™

> HP, MP, SANì€ ì„¸ì…˜ ì¤‘ ë³€ë™ë¨ â†’ ì„ì‹œ ì €ì¥ í›„ ì„¸ì…˜ ì¢…ë£Œ ì‹œ ë°˜ì˜

```javascript
// ì„¸ì…˜ ì¤‘ ìŠ¤íƒ¯ ë³€ë™ (í´ë¼ì´ì–¸íŠ¸)
async function updateCharacterStat(statType, newValue) {
  // Supabaseì— ì„ì‹œ ì €ì¥
  await roomChannel.send({
    type: 'broadcast',
    event: 'stat_update',
    payload: {
      ch_id: currentCharacter.ch_id,
      stat: statType,
      value: newValue
    }
  });

  // ë¡œê·¸ ê¸°ë¡
  await fetch('/ss_engine/api.php?mode=stat_update', {
    method: 'POST',
    body: JSON.stringify({
      room_id: roomId,
      ch_id: currentCharacter.ch_id,
      stat: statType,
      old_value: currentCharacter.derived[statType],
      new_value: newValue
    })
  });
}
```

### 7.0.2 ì„¸ì…˜ ë³´ìƒ ì‹œìŠ¤í…œ

> ì„¸ì…˜ ì°¸ì—¬/ì™„ì£¼ ì‹œ í¬ì¸íŠ¸ ì§€ê¸‰

```php
// ì„¸ì…˜ ì¢…ë£Œ ì‹œ ë³´ìƒ ì§€ê¸‰
function process_session_rewards($room_id) {
    global $g5;

    // ì°¸ê°€ì ëª©ë¡
    $sql = "SELECT * FROM {$g5['mg_ss_participant_table']}
            WHERE room_id = {$room_id} AND role = 'player'";
    $result = sql_query($sql);

    while ($participant = sql_fetch_array($result)) {
        $mb_id = $participant['mb_id'];
        $joined_at = strtotime($participant['joined_at']);
        $left_at = $participant['left_at']
            ? strtotime($participant['left_at'])
            : time();

        // ì°¸ì—¬ ì‹œê°„ ê³„ì‚° (ë¶„)
        $duration = ($left_at - $joined_at) / 60;

        // ê¸°ë³¸ ì°¸ì—¬ ë³´ìƒ
        $base_point = (int)mg_config('session_participate_point', 500);
        insert_point($mb_id, $base_point, "ì„¸ì…˜ ì°¸ì—¬ ë³´ìƒ (Room #{$room_id})");

        // ì™„ì£¼ ë³´ìƒ (ì„¸ì…˜ ì¢…ë£Œê¹Œì§€ ì°¸ì—¬)
        if (!$participant['left_at']) {
            $complete_point = (int)mg_config('session_complete_point', 1000);
            insert_point($mb_id, $complete_point, "ì„¸ì…˜ ì™„ì£¼ ë³´ìƒ (Room #{$room_id})");
        }

        // ì¥ì‹œê°„ ì°¸ì—¬ ë³´ë„ˆìŠ¤ (2ì‹œê°„ ì´ìƒ)
        if ($duration >= 120) {
            $long_bonus = (int)mg_config('session_long_bonus', 500);
            insert_point($mb_id, $long_bonus, "ì¥ì‹œê°„ ì„¸ì…˜ ë³´ë„ˆìŠ¤ (Room #{$room_id})");
        }
    }

    // GM ë³´ìƒ
    $room = get_session_room($room_id);
    $gm_point = (int)mg_config('session_gm_point', 2000);
    insert_point($room['gm_mb_id'], $gm_point, "GM ì§„í–‰ ë³´ìƒ (Room #{$room_id})");
}
```

### 7.1 ìºë¦­í„° ì—°ë™

```php
// ì„¸ì…˜ ì°¸ê°€ ì‹œ ìºë¦­í„° ì„ íƒ
function get_my_approved_characters($mb_id) {
    global $g5;

    $sql = "SELECT ch_id, ch_name, ch_thumb, side_id, class_id
            FROM {$g5['mg_character_table']}
            WHERE mb_id = '{$mb_id}'
            AND ch_state = 'approved'
            ORDER BY ch_main DESC, ch_name ASC";

    return sql_fetch_all($sql);
}

// ìºë¦­í„° ì •ë³´ â†’ ì„¸ì…˜ìš© ë°ì´í„°
function character_to_session_data($ch_id) {
    $char = get_character($ch_id);
    $profile = get_character_profile($ch_id);

    return [
        'ch_id' => $char['ch_id'],
        'ch_name' => $char['ch_name'],
        'ch_thumb' => $char['ch_thumb'],
        'name_color' => $profile['name_color'] ?? '#ffffff',
        'side_name' => get_side_name($char['side_id']),
        'class_name' => get_class_name($char['class_id']),
    ];
}
```

### 7.2 ìºë¦­í„° ì´ë¯¸ì§€ í™œìš©

```
ì„¸ì…˜ í™”ë©´ì—ì„œ ìºë¦­í„° í‘œì‹œ:
1. ch_thumb (ì¸ë„¤ì¼) â†’ ì±„íŒ… ì•„ë°”íƒ€
2. ch_thumb (í° ì´ë¯¸ì§€) â†’ ì”¬ ìºë¦­í„° í‘œì‹œ

NPCì˜ ê²½ìš°:
- ë³„ë„ ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ì‚¬ìš©
- ë˜ëŠ” Morgan Editionì˜ NPC ìºë¦­í„° ì—°ë™
```

---

## 8. ë¦¬í”Œë ˆì´ ì‹œìŠ¤í…œ

### 8.1 ì„¸ì…˜ ë¡œê·¸ â†’ VN ë…¸ë“œ ë³€í™˜

```php
// ì„¸ì…˜ ì¢…ë£Œ ì‹œ ë¦¬í”Œë ˆì´ ë°ì´í„° ìƒì„±
function create_replay_data($room_id) {
    $logs = get_session_logs($room_id);
    $nodes = [];

    foreach ($logs as $log) {
        switch ($log['log_type']) {
            case 'chat':
                $nodes[] = [
                    'type' => 'dialogue',
                    'speaker' => $log['speaker_name'],
                    'speaker_color' => $log['speaker_color'],
                    'content' => $log['content'],
                    'char_img' => get_character_image($log['ch_id']),
                ];
                break;

            case 'dice':
                $nodes[] = [
                    'type' => 'dialogue',
                    'speaker' => $log['speaker_name'],
                    'content' => "ğŸ² " . $log['dice_result'],
                    'is_dice' => true,
                ];
                break;

            case 'scene':
                $extra = json_decode($log['extra_data'], true);
                $nodes[] = [
                    'type' => 'scene_change',
                    'bg_img' => get_scene_image($extra['scene_id']),
                    'scene_name' => $extra['scene_name'],
                ];
                break;

            case 'bgm':
                $extra = json_decode($log['extra_data'], true);
                $nodes[] = [
                    'type' => 'bgm_change',
                    'bgm_key' => $extra['bgm_id'],
                ];
                break;

            case 'system':
                $nodes[] = [
                    'type' => 'system',
                    'content' => $log['content'],
                ];
                break;
        }
    }

    return json_encode($nodes);
}
```

### 8.2 ë¦¬í”Œë ˆì´ ë·°ì–´

```
vn_engineì˜ play.php êµ¬ì¡° í™œìš©:

1. ë…¸ë“œ ìˆœì°¨ ì¬ìƒ
2. ìºë¦­í„° í‘œì‹œ + ëŒ€ì‚¬ íƒ€ì´í•‘
3. ì”¬/BGM ì „í™˜
4. ë‹¤ì´ìŠ¤ ê²°ê³¼ í‘œì‹œ

ì¶”ê°€ ê¸°ëŠ¥:
- ì†ë„ ì¡°ì ˆ (0.5x ~ 3x)
- íŠ¹ì • ì§€ì ìœ¼ë¡œ ì´ë™ (íƒ€ì„ë¼ì¸)
- ìë™/ìˆ˜ë™ ì§„í–‰ ì „í™˜
```

### 8.3 ë¦¬í”Œë ˆì´ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [< ëª©ë¡] ë¦¬í”Œë ˆì´: ë˜ì „ íƒí—˜ #3              [ê³µìœ ] [ì›ë³¸ ë¡œê·¸] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    [ë°°ê²½ ì´ë¯¸ì§€]                        â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚  â”‚              â”‚     â”‚                                    â”‚   â”‚
â”‚  â”‚              â”‚ ìºA â”‚                                    â”‚   â”‚
â”‚  â”‚              â”‚     â”‚                                    â”‚   â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”˜                                    â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ [ì•„ë¦¬ì•„]                                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ ì—¬ê¸°ê°€ ë˜ì „ ì…êµ¬ì¸ ê²ƒ ê°™ì•„.                        â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â—‹]        â”‚
â”‚  00:05:23 / 01:45:30                                           â”‚
â”‚                                                                 â”‚
â”‚  [â®] [âª] [â–¶ ì¬ìƒ] [â©] [â­]     ì†ë„: [1x â–¼]     [Auto]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. ì„¤ì¹˜ ê°€ì´ë“œ

### 9.1 ì„¤ì¹˜ ì ˆì°¨

```
ğŸ“¦ SS Engine ì„¤ì¹˜ ê°€ì´ë“œ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 1: íŒŒì¼ ì—…ë¡œë“œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ss_engine/ í´ë”ë¥¼ Morgan Edition ë£¨íŠ¸ì— ì—…ë¡œë“œ
ì˜ˆ: /www/morgan/ss_engine/

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 2: Supabase ì„¤ì •
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. https://supabase.com ì ‘ì†
2. íšŒì›ê°€ì… (ë¬´ë£Œ)
3. "New Project" í´ë¦­
4. í”„ë¡œì íŠ¸ ì´ë¦„, ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
5. Region: Northeast Asia (Tokyo) ê¶Œì¥
6. "Create new project" í´ë¦­
7. ìƒì„± ì™„ë£Œê¹Œì§€ ëŒ€ê¸° (ì•½ 2ë¶„)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 3: API í‚¤ ë³µì‚¬
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. ì¢Œì¸¡ ë©”ë‰´ > Settings > API
2. "Project URL" ë³µì‚¬
   ì˜ˆ: https://abcd1234.supabase.co
3. "anon public" í‚¤ ë³µì‚¬
   ì˜ˆ: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 4: config.php ì„¤ì •
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. config.sample.phpë¥¼ config.phpë¡œ ë³µì‚¬
2. ë³µì‚¬í•œ ê°’ ì…ë ¥:

<?php
define('SS_SUPABASE_URL', 'https://abcd1234.supabase.co');
define('SS_SUPABASE_ANON_KEY', 'eyJhbGciOiJIUzI1Ni...');
?>

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 5: ì„¤ì¹˜ ì‹¤í–‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†:
https://yourdomain.com/ss_engine/install.php

[ì„¤ì¹˜] ë²„íŠ¼ í´ë¦­
â†’ Morgan Edition í…Œì´ë¸” í™•ì¸
â†’ SS Engine í…Œì´ë¸” ìƒì„±
â†’ Supabase ì—°ê²° í…ŒìŠ¤íŠ¸
â†’ ì™„ë£Œ!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 6: ì™„ë£Œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
https://yourdomain.com/ss_engine/
ì ‘ì†í•˜ì—¬ ì„¸ì…˜ ìƒì„±!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### 9.2 install.php ì²´í¬ë¦¬ìŠ¤íŠ¸

```php
// install.php ìˆ˜í–‰ ì‘ì—…
$checks = [
    // Morgan Edition í™•ì¸
    'Morgan Edition ì„¤ì¹˜ í™•ì¸',
    'mg_member í…Œì´ë¸” ì¡´ì¬',
    'mg_character í…Œì´ë¸” ì¡´ì¬',

    // SS Engine í…Œì´ë¸” ìƒì„±
    'mg_ss_room í…Œì´ë¸” ìƒì„±',
    'mg_ss_scene í…Œì´ë¸” ìƒì„±',
    'mg_ss_bgm í…Œì´ë¸” ìƒì„±',
    'mg_ss_participant í…Œì´ë¸” ìƒì„±',
    'mg_ss_npc í…Œì´ë¸” ìƒì„±',
    'mg_ss_log í…Œì´ë¸” ìƒì„±',
    'mg_ss_replay í…Œì´ë¸” ìƒì„±',

    // Supabase ì—°ê²° í…ŒìŠ¤íŠ¸
    'config.php ì¡´ì¬ í™•ì¸',
    'Supabase URL ìœ íš¨ì„±',
    'Supabase API í‚¤ ìœ íš¨ì„±',
    'Supabase ì—°ê²° í…ŒìŠ¤íŠ¸',
];
```

---

## 10. API ì—”ë“œí¬ì¸íŠ¸

### 10.1 ì„¸ì…˜ ê´€ë¦¬

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | /ss_engine/api.php?mode=room_list | ì„¸ì…˜ ëª©ë¡ |
| GET | /ss_engine/api.php?mode=room_get&id={room_id} | ì„¸ì…˜ ìƒì„¸ |
| POST | /ss_engine/api.php?mode=room_create | ì„¸ì…˜ ìƒì„± |
| POST | /ss_engine/api.php?mode=room_update | ì„¸ì…˜ ìˆ˜ì • |
| POST | /ss_engine/api.php?mode=room_delete | ì„¸ì…˜ ì‚­ì œ |
| POST | /ss_engine/api.php?mode=room_start | ì„¸ì…˜ ì‹œì‘ |
| POST | /ss_engine/api.php?mode=room_pause | ì„¸ì…˜ ì¼ì‹œì •ì§€ |
| POST | /ss_engine/api.php?mode=room_end | ì„¸ì…˜ ì¢…ë£Œ |

### 10.2 ì°¸ê°€ì ê´€ë¦¬

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | /ss_engine/api.php?mode=join | ì„¸ì…˜ ì°¸ê°€ |
| POST | /ss_engine/api.php?mode=leave | ì„¸ì…˜ í‡´ì¥ |
| GET | /ss_engine/api.php?mode=participants | ì°¸ê°€ì ëª©ë¡ |

### 10.3 GM ì œì–´

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | /ss_engine/api.php?mode=scene_list | ì”¬ ëª©ë¡ |
| POST | /ss_engine/api.php?mode=scene_add | ì”¬ ì¶”ê°€ |
| POST | /ss_engine/api.php?mode=scene_change | ì”¬ ë³€ê²½ |
| GET | /ss_engine/api.php?mode=bgm_list | BGM ëª©ë¡ |
| POST | /ss_engine/api.php?mode=bgm_add | BGM ì¶”ê°€ |
| POST | /ss_engine/api.php?mode=bgm_change | BGM ë³€ê²½ |
| GET | /ss_engine/api.php?mode=npc_list | NPC ëª©ë¡ |
| POST | /ss_engine/api.php?mode=npc_add | NPC ì¶”ê°€ |
| POST | /ss_engine/api.php?mode=npc_control | NPC ì œì–´ |

### 10.4 ë¡œê·¸/ë¦¬í”Œë ˆì´

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | /ss_engine/api.php?mode=log_add | ë¡œê·¸ ì¶”ê°€ |
| GET | /ss_engine/api.php?mode=log_list | ë¡œê·¸ ëª©ë¡ |
| GET | /ss_engine/api.php?mode=replay_list | ë¦¬í”Œë ˆì´ ëª©ë¡ |
| GET | /ss_engine/api.php?mode=replay_get | ë¦¬í”Œë ˆì´ ë°ì´í„° |
| POST | /ss_engine/api.php?mode=replay_create | ë¦¬í”Œë ˆì´ ìƒì„± |

---

## 11. ê°œë°œ ë¡œë“œë§µ

### Phase 2-1: ê¸°ë°˜ êµ¬ì¶•
- [ ] í´ë” êµ¬ì¡° ìƒì„±
- [ ] DB í…Œì´ë¸” ìƒì„± (install.php)
- [ ] config ì„¤ì • ì‹œìŠ¤í…œ
- [ ] Supabase ì—°ë™ ê¸°ë³¸

### Phase 2-2: í•µì‹¬ ê¸°ëŠ¥
- [ ] ì„¸ì…˜ ìƒì„±/ê´€ë¦¬ CRUD
- [ ] ì‹¤ì‹œê°„ ì±„íŒ… (Supabase Broadcast)
- [ ] ì°¸ê°€ì ê´€ë¦¬ (Supabase Presence)
- [ ] ë‹¤ì´ìŠ¤ ì‹œìŠ¤í…œ

### Phase 2-3: GM ê¸°ëŠ¥
- [ ] GM ì œì–´íŒ UI
- [ ] ì”¬/ë°°ê²½ ê´€ë¦¬
- [ ] BGM ê´€ë¦¬
- [ ] NPC ê´€ë¦¬
- [ ] ì‹œìŠ¤í…œ ë©”ì‹œì§€

### Phase 2-4: ìºë¦­í„° ì—°ë™
- [ ] Morgan Edition ìºë¦­í„° ì—°ë™
- [ ] ìºë¦­í„° ì„ íƒ UI
- [ ] ìºë¦­í„° ì´ë¯¸ì§€ í‘œì‹œ

### Phase 2-5: ë¦¬í”Œë ˆì´
- [ ] ì„¸ì…˜ ë¡œê·¸ ì €ì¥
- [ ] ë¡œê·¸ â†’ VN ë…¸ë“œ ë³€í™˜
- [ ] ë¦¬í”Œë ˆì´ ë·°ì–´ (vn_engine í™œìš©)
- [ ] ê³µê°œ/ë¹„ê³µê°œ ì„¤ì •

### Phase 2-6: ë§ˆë¬´ë¦¬
- [ ] ì„¤ì¹˜ ê°€ì´ë“œ ì™„ì„±
- [ ] UI ë‹¤ë“¬ê¸°
- [ ] í…ŒìŠ¤íŠ¸
- [ ] ë¬¸ì„œí™”

---

## 12. ì°¸ê³  ìë£Œ

- vn_engine ì†ŒìŠ¤: `F:\projects\vn_engine\vn_engine`
- ì½”ì½”í´ë¦¬ì•„: https://ccfolia.com
- Supabase Realtime: https://supabase.com/docs/guides/realtime
- Supabase Presence: https://supabase.com/docs/guides/realtime/presence

---

## 13. TODO

- [ ] vn_engineì—ì„œ ì¬ì‚¬ìš©í•  ì½”ë“œ ì¶”ì¶œ
- [ ] Supabase í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ ìƒì„±
- [ ] í”„ë¡œí† íƒ€ì… UI ì„¤ê³„
- [ ] ë‹¤ì´ìŠ¤ ì‹œìŠ¤í…œ êµ¬í˜„
- [ ] ë¦¬í”Œë ˆì´ ë³€í™˜ ë¡œì§ ì„¤ê³„

---

*ì‘ì„±ì¼: 2026-02-03*
*ìƒíƒœ: 2ì°¨ ê°œë°œ ëŒ€ê¸° (ê¸°íš ì™„ë£Œ)*
*ìš°ì„ ìˆœìœ„: ë†’ìŒ (í‚¬ëŸ¬ ì½˜í…ì¸ )*
