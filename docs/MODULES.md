# Morgan Edition - 프리미엄 모듈 기획서

> 작성일: 2026-02-04
> 상태: 기획 초안
> 비고: 코어 CMS 완성 후 순차 개발 예정

---

## 개요

Morgan Edition CMS의 핵심 차별화 요소가 될 3가지 프리미엄 모듈.
코어 CMS는 무료로 제공하고, 이 모듈들은 베타 테스터 체험 후 유료화 예정.

### 모듈 목록

| 모듈 | 한줄 요약 | 의존성 |
|------|----------|--------|
| VN Engine | 역극 → 비주얼 노벨 자동 변환 | 역극 게시판, 캐릭터 시스템 |
| SS Engine | 지속 가능한 실시간 TRPG 세션 | 캐릭터 시스템, 진영 시스템 |
| 익명망 | 진영별 인트라넷 (코드네임 익명 게시판) | 진영 시스템 |

### 핵심 철학

**"따로 쓰면 그냥 그런데, Morgan이랑 붙으면 시너지"**

- 각 모듈은 Morgan CMS 없이는 반쪽짜리
- CMS의 캐릭터/진영/포인트 시스템과 깊게 연동
- 기존 대체재(코코폴리아, 롤20, 일반 익명 게시판)와 차별화

---

## 1. VN Engine (Visual Novel Engine)

### 1.1 핵심 가치

**"내가 쓴 역극이 비주얼 노벨이 된다"**

- 역극 게시판의 글을 VN 형식으로 자동 변환
- 캐릭터 정보(이미지, 이름, 색상) 자동 연동
- 별도 편집 없이 바로 플레이 가능한 VN 생성

### 1.2 기존 대체재와 차이점

| 기존 방식 | VN Engine |
|----------|-----------|
| 역극 → 수동으로 VN 제작 | 역극 → **자동 변환** |
| 캐릭터 이미지 일일이 지정 | CMS 캐릭터 데이터 **자동 연동** |
| 별도 툴 필요 (티라노, 렌파이) | **웹에서 바로 플레이** |

### 1.3 주요 기능

#### 역극 → VN 변환
```
[역극 게시판 원본]
A: "여기가 그 장소야?"
B: "조심해. 뭔가 이상해."
A: *주변을 둘러본다*

    ↓ [VN 변환]

[VN Player]
- A 캐릭터 이미지 표시
- 대사창에 "여기가 그 장소야?" 출력
- 다음 버튼 → B로 전환
- 지문(*...*) → 나레이션 처리
```

#### 변환 규칙 (파싱)
| 원본 패턴 | VN 변환 결과 |
|----------|-------------|
| `캐릭터명: "대사"` | 해당 캐릭터 표시 + 대사창 |
| `*행동 묘사*` | 나레이션 (캐릭터 없이) |
| `---` 또는 빈 줄 | 씬 구분 |
| `[배경: 장소명]` | 배경 이미지 변경 (선택적) |

#### 캐릭터 연동
- `mg_character` 테이블에서 자동 매칭
- 캐릭터명 → 썸네일 이미지, 이름 색상 가져옴
- 매칭 실패 시 기본 실루엣 + 입력된 이름 사용

#### 플레이어 기능
- 자동/수동 진행
- 속도 조절 (0.5x ~ 3x)
- 타임라인 이동 (특정 대사로 점프)
- 공유 링크 생성

### 1.4 Morgan CMS 연동 사항

| 연동 대상 | 연동 내용 |
|----------|----------|
| **역극 게시판** | 원본 데이터 소스 |
| **캐릭터 시스템** | 이미지, 이름, 색상 자동 매칭 |
| **포인트 시스템** | VN 조회수에 따른 보상 (선택적) |

### 1.5 기술 스택

- 기존 vn_engine 코드베이스 활용 (`F:\projects\vn_engine`)
- PHP + Vanilla JS
- 역극 파싱 로직 신규 개발 필요

### 1.6 데이터 흐름

```
[역극 게시판]
    │
    ▼ (변환 버튼 클릭)
[파서] ─────────────────────────┐
    │                          │
    │ 캐릭터명 추출              │
    ▼                          ▼
[mg_character 조회]      [VN 노드 생성]
    │                          │
    │ 이미지/색상               │ JSON 형태
    ▼                          ▼
[VN 데이터 완성] ◀──────────────┘
    │
    ▼
[VN Player 렌더링]
```

---

## 2. SS Engine (Session Engine)

### 2.1 핵심 가치

**"한판 땡이 아닌, 지속 가능한 TRPG"**

- 세션 결과가 캐릭터 성장에 반영
- 세션 로그가 자동 저장되고 VN으로 리플레이 가능
- 커뮤니티 세계관에 세션 기록이 쌓임

### 2.2 기존 대체재와 차이점

| 기존 (코코폴리아, 롤20) | SS Engine |
|------------------------|-----------|
| 세션 → 끝 → 로그 묻힘 | 세션 → **캐릭터 성장 반영** |
| 별도 캐릭터 시트 관리 | CMS 캐릭터 **자동 연동** |
| 리플레이 = 로그 텍스트 | 리플레이 = **VN 형식 재생** |
| 단발성 세션 | **캠페인 (장기 연속)** |

### 2.3 주요 기능

#### 실시간 세션
- 4인 기준 파티 (탱/딜/딜/힐 또는 자유)
- Supabase Realtime 기반 실시간 통신
- GM 제어판 (씬, BGM, NPC, 시스템 메시지)

#### 다이스 시스템 (멀티 룰셋)
| 룰셋 | 기본 다이스 | 특징 |
|------|------------|------|
| CoC 7판 | d100 | 기술치 이하 성공, 5단계 레벨 |
| D&D 5e | d20 | 수정치 + d20 vs DC |
| VtM 5판 | d10 풀 | 성공 카운트, 헝거 다이스 |
| 커스텀 | 자유 | 운영자 정의 |

#### 캐릭터 성장 연동
```
[세션 종료]
    │
    ├── 참여 보상: 500P
    ├── 완주 보상: 1000P
    ├── 장시간 보너스: 500P (2시간+)
    ├── GM 보상: 2000P
    │
    └── 스탯 변동 반영 (HP, SAN 등)
         ↓
    [mg_character 업데이트]
```

#### 세션 → VN 리플레이
- 세션 로그 자동 저장 (`mg_ss_log`)
- 종료 시 VN 노드로 자동 변환
- VN Engine과 연동하여 리플레이 제공

### 2.4 Morgan CMS 연동 사항

| 연동 대상 | 연동 내용 |
|----------|----------|
| **캐릭터 시스템** | 승인된 캐릭터만 참가 가능 |
| **캐릭터 스탯** | CoC 스탯 자동 로드, 세션 중 변동 반영 |
| **포인트 시스템** | 세션 보상 자동 지급 |
| **진영 시스템** | 진영별 세션 분류 (선택적) |
| **VN Engine** | 리플레이 자동 생성 |

### 2.5 기술 스택

- PHP 8.x (서버 로직, API)
- MySQL (메타데이터, 로그 저장)
- Supabase Realtime (실시간 통신)
- Vanilla JS + Supabase JS Client

### 2.6 데이터 흐름

```
[세션 생성]
    │
    ▼
[참가자 입장] ──── mg_character 조회
    │
    ▼
[실시간 세션] ◀───▶ [Supabase Realtime]
    │
    │  채팅, 다이스, 씬 변경...
    │
    ▼
[로그 저장] ────── mg_ss_log INSERT
    │
    ▼
[세션 종료]
    │
    ├── 보상 지급 → mg_member.mb_point
    ├── 스탯 반영 → mg_character_stat
    └── VN 변환 → mg_ss_replay
```

### 2.7 상세 기획 문서

> 참고: `F:\projects\new_cms\docs\PLAN_SS_ENGINE.md`

---

## 3. 익명망 (진영별 인트라넷)

### 3.1 핵심 가치

**"캐릭터 이입 + 반익명 = 추리의 재미"**

- 듀라라라의 "다라즈" 같은 진영별 비밀 네트워크
- 캐릭터로 이입하되, 코드네임으로 활동
- "떠도는 개 01이 누구지?" → 추측과 떡밥의 공간

### 3.2 기존 대체재와 차이점

| 완전 익명 | 완전 실명 | **반익명 (익명망)** |
|----------|----------|-------------------|
| 추측 불가 | 추측 필요 없음 | **추측 가능** |
| 무책임 | 부담감 | **긴장감 + 자유** |
| 몰입 약함 | 서사 없음 | **"들킬까?" 긴장** |

### 3.3 주요 기능

#### 코드네임 시스템
```
진영별 접두어 + 숫자

뱀파이어: 7대 죄악
├── 색욕 01, 탐식 03, 나태 07...

라이칸스로프: 동물
├── 떠도는 개 01, 굶주린 늑대 05...

헌터: 직급
├── 요원 01, 감시자 03, 처리반 07...
```

#### 시즌 리셋
- 분기/시즌마다 코드네임 초기화
- 메타 정보 리셋 ("색욕03 = 누구" 무효화)
- 새 시즌 = 새로운 추리 시작

#### 진영 간 접근 제어
- 기본: 자기 진영 게시판만 접근 가능
- 이벤트 시: "잠입" 허용 (읽기 전용 등)
- 특수 권한: 스파이 역할 부여 가능

#### NPC 운영 지원
```
관리자 NPC (예시):
├── 뱀파이어: 요나 (네트워크 관리자)
├── 라이칸스로프: 밀라 (정보통)
├── 헌터: 그레이스 (보안 담당)
└── 전체: 에스더 (상위 개입)

역할:
├── 분위기 조성 (초반 적막 방지)
├── 신규 환영 메시지
├── 이벤트 떡밥 투척
└── 갈등 중재
```

### 3.4 Morgan CMS 연동 사항

| 연동 대상 | 연동 내용 |
|----------|----------|
| **진영 시스템** | 진영별 게시판 분리, 접근 제어 |
| **캐릭터 시스템** | 코드네임 ↔ 실제 캐릭터 매핑 |
| **포인트 시스템** | 활동 보상 (글/댓글) |

### 3.5 UI 컨셉

진영별 테마 (기존 moonveil 참고):

| 진영 | 테마 | UI 컨셉 |
|------|------|---------|
| 뱀파이어 | 터미널/해킹 | `root@scarlet-echo:~$` |
| 라이칸스로프 | 야생/경고 | `[!] PREDATOR NEARBY` |
| 헌터 | 군사/기밀 | `WRO: CLASSIFIED` |

### 3.6 데이터 구조

#### mg_anon_season (시즌 관리)
| 필드 | 설명 |
|------|------|
| season_id | PK |
| season_name | "2026년 1분기" |
| start_date | 시작일 |
| end_date | 종료일 |
| is_active | 현재 활성 시즌 |

#### mg_anon_codename (코드네임 할당)
| 필드 | 설명 |
|------|------|
| id | PK |
| season_id | FK → 시즌 |
| ch_id | FK → 캐릭터 |
| side_id | FK → 진영 |
| codename | "색욕 03" |
| color | 이름 색상 |

#### mg_anon_board (익명 게시글)
| 필드 | 설명 |
|------|------|
| post_id | PK |
| side_id | 진영 |
| codename_id | FK → 코드네임 |
| subject | 제목 |
| content | 내용 |
| created_at | 작성일 |

### 3.7 레퍼런스

- 듀라라라 "다라즈" (익명 채팅방)
- 기존 구현: `F:\projects\vn_engine\moonveil\board\vamp.php`

---

## 모듈 간 연동 관계

```
┌─────────────────────────────────────────────────────┐
│                 Morgan Edition CMS                  │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐       │
│  │  회원     │  │  캐릭터   │  │  진영     │       │
│  │  시스템   │  │  시스템   │  │  시스템   │       │
│  └─────┬─────┘  └─────┬─────┘  └─────┬─────┘       │
│        │              │              │              │
│        └──────────────┼──────────────┘              │
│                       │                             │
├───────────────────────┼─────────────────────────────┤
│                       ▼                             │
│  ┌─────────────────────────────────────────────┐   │
│  │              역극 게시판                     │   │
│  └──────────────────┬──────────────────────────┘   │
│                     │                               │
│         ┌───────────┴───────────┐                  │
│         ▼                       ▼                  │
│  ┌─────────────┐         ┌─────────────┐          │
│  │  VN Engine  │◀────────│  SS Engine  │          │
│  │  (리플레이)  │ 세션로그 │  (실시간)   │          │
│  └─────────────┘  변환    └──────┬──────┘          │
│                                  │                 │
│                          ┌──────┴──────┐          │
│                          ▼             ▼          │
│                    [캐릭터 성장]  [세계관 기록]    │
│                                                    │
├────────────────────────────────────────────────────┤
│                       │                            │
│                       ▼                            │
│              ┌─────────────┐                       │
│              │   익명망    │                       │
│              │ (진영 연동) │                       │
│              └─────────────┘                       │
│                                                    │
└────────────────────────────────────────────────────┘
```

---

## 수익화 전략

### 가격 구조 (안)

| 모듈 | 단독 가격 | 비고 |
|------|----------|------|
| VN Engine | 2~3만원 | 역극 변환 |
| SS Engine | 3~5만원 | 실시간 세션 |
| 익명망 | 1~2만원 | 진영 부가기능 |
| **풀 번들** | 5~8만원 | 할인 묶음 |

### 설치 대행 패키지

| 패키지 | 가격 | 포함 내용 |
|--------|------|----------|
| 기본 설치 | 5만원 | CMS + 모듈 1개 + 초기 세팅 |
| 풀 설치 | 10만원 | CMS + 전체 모듈 + 초기 세팅 |
| 커스텀 | 협의 | 스킨 수정, 추가 기능 |

### 단계별 전략

```
[1단계] 베타
├── 전체 기능 무료 체험
├── 2~3개 커뮤 한정
└── 피드백 수집

[2단계] 정식 출시
├── 코어 CMS 무료
├── 모듈 유료화
└── "베타에서 쓰던 그 기능" = 지불 의향 높음

[3단계] 확장
├── 신규 모듈 개발
├── 커스텀 의뢰 수주
└── 기술 지원 구독 (월정액)
```

---

## 개발 우선순위

```
[현재] Phase 1: Morgan CMS 코어
├── 회원/캐릭터/게시판/포인트
├── 역극 게시판 (VN 원본)
└── 진영 시스템 (익명망 전제)

[다음] Phase 2: 베타 운영
├── 테스터 모집 (2~3개 커뮤)
├── 피드백 기반 개선
└── 모듈 필요성 검증

[이후] Phase 3: 모듈 개발
├── VN Engine (역극 변환) ← 가장 쉬움
├── 익명망 (진영 연동) ← 기존 코드 있음
└── SS Engine (실시간) ← 가장 복잡

[최종] Phase 4: 유료화
├── 가격 책정
├── 결제 시스템
└── 라이선스 관리
```

---

## 참고 자료

- VN Engine 기존 코드: `F:\projects\vn_engine`
- SS Engine 상세 기획: `F:\projects\new_cms\docs\PLAN_SS_ENGINE.md`
- 익명망 기존 구현: `F:\projects\vn_engine\moonveil\board`
- Morgan CMS 전체 기획: `F:\projects\new_cms\docs\OVERVIEW.md`

---

*버전: 1.0*
*다음 업데이트: 베타 피드백 반영 후*
